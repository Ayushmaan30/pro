<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Our Forever Story ‚ù§Ô∏è</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --p-pink: #ff4d6d;
            --d-pink: #800f2f;
            --gold: #d4af37;
        }

        body { 
            font-family: 'Poppins', sans-serif; 
            margin: 0; 
            background-attachment: fixed;
            background-size: cover;
            background-position: center;
            cursor: none !important;
            overflow: hidden; 
            background-color: #000;
        }

        a, button, .option-btn, .btn-yes, .map-point, .control-btn, .song-card { cursor: none !important; }

        #panda-pet {
            position: fixed; width: 50px; height: 50px; pointer-events: none;
            z-index: 100000; font-size: 40px; display: flex; align-items: center;
            justify-content: center; user-select: none;
            transition: transform 0.1s ease-out;
        }

        .trail {
            position: fixed; height: 10px; width: 10px; border-radius: 50%;
            background: var(--p-pink); pointer-events: none; z-index: 99999;
            animation: sparkleFade 0.8s forwards;
        }
        @keyframes sparkleFade {
            0% { transform: scale(1); opacity: 1; }
            100% { transform: scale(0); opacity: 0; }
        }

        #love-meter-container {
            position: fixed; top: 20px; left: 20px; z-index: 9999;
            background: rgba(255,255,255,0.9); padding: 10px 15px;
            border-radius: 50px; display: none; align-items: center; gap: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1); border: 2px solid var(--p-pink);
        }
        #love-meter-fill { height: 12px; width: 0%; background: linear-gradient(90deg, #ff758c, #ff4d6d); border-radius: 10px; transition: width 0.5s ease; }

        .page-section { display: none; min-height: 100vh; flex-direction: column; align-items: center; justify-content: center; position: relative; z-index: 2; width: 100%; }
        .active-section { display: flex; animation: cinematicFade 1.5s ease-in-out; }
        
        @keyframes cinematicFade {
            0% { opacity: 0; filter: blur(10px); transform: scale(1.05); }
            100% { opacity: 1; filter: blur(0px); transform: scale(1); }
        }

        /* Interactive Gallery Tiles */
        .scroll-item { 
            display: inline-block; width: 350px; background: white; padding: 15px 15px 40px 15px; 
            box-shadow: 0 30px 60px rgba(0,0,0,0.9); transform: rotate(var(--rotation)); 
            transition: 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); white-space: normal; 
            border: 5px solid white;
        }
        .scroll-item:hover {
            transform: rotate(0deg) scale(1.1) !important;
            z-index: 100;
            box-shadow: 0 40px 80px rgba(255, 77, 109, 0.4);
            border-color: var(--p-pink);
        }

        /* Certificate Golden Border & Wax Seal Movement */
        .certificate-container {
            background: #fff; padding: 25px; 
            border: 8px double var(--gold); /* Golden Border */
            outline: 15px solid #d4af37; outline-offset: -35px;
            width: 95%; max-width: 750px; position: relative; 
            box-shadow: 0 30px 70px rgba(0,0,0,0.4); text-align: center;
        }
        .wax-seal { 
            width: 110px; height: 110px; background: radial-gradient(#c00, #800); 
            border-radius: 50%; margin: 0 auto; display: flex; align-items: center; 
            justify-content: center; color: #ffd700; font-family: 'Dancing Script'; 
            font-size: 1.4rem; box-shadow: 2px 5px 15px rgba(0,0,0,0.4); 
            animation: sealRotate 5s linear infinite; /* Seal Movement */
            border: 2px dashed rgba(255,255,255,0.2); 
        }
        @keyframes sealRotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* Developer Credit Page Styles */
        #developer-credit { background: radial-gradient(circle, #1a1a1a, #000); color: white; }
        .dev-card {
            border: 1px solid rgba(255,255,255,0.1);
            padding: 40px; border-radius: 30px;
            background: rgba(255,255,255,0.03);
            backdrop-filter: blur(10px);
        }
        .glow-text {
            background: linear-gradient(to right, #fff, var(--p-pink), #fff);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: bold; letter-spacing: 5px;
        }

        /* Keep existing styles */
        .quiz-card { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); border: 3px solid #ffccd5; transition: all 0.4s ease; }
        .option-btn { transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); border: 2px solid var(--p-pink) !important; color: var(--p-pink); background: transparent; }
        .option-btn:hover { transform: scale(1.05) translateY(-3px); background-color: var(--p-pink) !important; color: white !important; box-shadow: 0 10px 20px rgba(255, 77, 109, 0.3); }
        .shake { animation: shake 0.4s; }
        @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-10px); } 75% { transform: translateX(10px); } }
        .song-card { background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.2); padding: 20px; border-radius: 20px; transition: 0.3s; color: white; width: 100%; margin-bottom: 15px; }
        .song-card:hover { background: var(--p-pink); transform: translateY(-5px); }
        #adventure-map { width: 100%; max-width: 800px; height: 500px; background: url('p8.jpeg'), #222; background-position: top center; background-size: cover; border-radius: 20px; position: relative; border: 10px solid #f3e5ab; box-shadow: 0 20px 40px rgba(0,0,0,0.3); margin: 20px auto; overflow: hidden; }
        .map-point { position: absolute; transform: translate(-50%, -50%); transition: transform 0.3s; z-index: 10; cursor: pointer; color: white; font-weight: bold; text-shadow: 2px 2px 10px rgba(0,0,0,0.8); display: flex; flex-direction: column; align-items: center; }
        .heart-icon { font-size: 2.5rem; animation: heartbeat 1.5s infinite; }
        @keyframes heartbeat { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.15); } }
        #cinematic-gallery { background: #0a0a0a; width: 100vw; height: 100vh; overflow-x: auto; overflow-y: hidden; white-space: nowrap; display: flex; align-items: center; scrollbar-width: none; position: relative; }
        .vignette-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: radial-gradient(circle, transparent 40%, rgba(0,0,0,0.8) 100%); pointer-events: none; z-index: 10; }
        .horizontal-track { display: inline-flex; padding: 0 15vw; align-items: center; gap: 150px; z-index: 5; }
        .scroll-item img { width: 100%; height: 280px; object-fit: cover; }
        .scroll-item p { font-family: 'Dancing Script'; font-size: 1.5rem; text-align: center; margin-top: 15px; color: #222; }
        #souvenir { background: #fdf6e3; background-image: radial-gradient(#fff9e6 1px, transparent 1px); background-size: 20px 20px; }
        .certificate-inner { border: 1px solid #d4af37; padding: 60px 40px; background: rgba(255, 255, 255, 0.8); }
        .cert-header { font-family: 'Poppins'; letter-spacing: 7px; color: #888; font-size: 0.9rem; margin-bottom: 10px; }
        .cert-title { font-family: 'Dancing Script'; font-size: 4.5rem; color: var(--d-pink); margin: 10px 0; text-shadow: 1px 1px 2px rgba(0,0,0,0.1); }
        .cert-names { font-family: 'Dancing Script'; font-size: 3rem; color: #333; background: linear-gradient(transparent 80%, rgba(255, 77, 109, 0.2) 20%); display: inline-block; padding: 0 40px; margin: 25px 0; }
        .cert-footer { display: flex; justify-content: space-between; align-items: flex-end; margin-top: 40px; }
        .cert-signature { border-top: 2px solid #eee; padding-top: 5px; width: 150px; font-family: 'Dancing Script'; font-size: 1.2rem; }
        .bg-video { position: fixed; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; z-index: 0; pointer-events: none; display: none; }
        body.bg-welcome #welcomeVideo, body.bg-letter #letterVideo { display: block; }
        body.bg-quiz { background: linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.6)), url('p4.jpg') center/cover; }
        body.bg-story { background: #1a1a1a; }
        body.bg-proposal { background: linear-gradient(rgba(0,0,0,0.7), rgba(0,0,0,0.7)), url('https://images.unsplash.com/photo-1515934751635-c81c6bc9a2d8?q=80&w=2070') center/cover; }
        body.bg-souvenir { background: #fdf6e3; }
        .btn-yes { background: var(--p-pink); color: white; font-size: 1.5rem; padding: 15px 60px; border-radius: 50px; border: none; animation: pulse 1.5s infinite; }
        @keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } }
        .heart-digit { width: 45px; height: 45px; background: #eee; display: flex; align-items: center; justify-content: center; font-weight: bold; color: white; font-size: 1.2rem; clip-path: path('M24 43.15l-3.05-2.75C9.1 30.35 2 23.95 2 16.15 2 9.75 7 4.75 13.4 4.75c3.6 0 7.05 1.65 9.3 4.3 2.25-2.65 5.7-4.3 9.3-4.3 6.4 0 11.4 5 11.4 11.4 0 7.8-7.1 14.2-18.95 24.3L24 43.15z'); transition: all 0.3s ease; cursor: pointer; }
        .heart-digit.filled { background: var(--p-pink); transform: scale(1.1); box-shadow: 0 0 15px rgba(255, 77, 109, 0.5); animation: heartBeat 0.4s ease-out; }
        @keyframes heartBeat { 0% { transform: scale(1); } 50% { transform: scale(1.3); } 100% { transform: scale(1.1); } }
    </style>
</head>
<body class="bg-welcome">

    <audio id="bgMusic" loop></audio>
    <div id="panda-pet">üêº</div>

    <section id="music-select" class="page-section active-section">
        <div class="text-center text-white">
            <h2 class="mb-4" style="font-family: 'Dancing Script'; font-size: 3.5rem;">Pick our theme song...</h2>
            <div style="max-width: 400px; margin: auto;">
                <button class="song-card btn" onclick="selectMusic('ghera.mp3')">üéµ GHERA HUA</button>
                <button class="song-card btn" onclick="selectMusic('sahi.mp3')">üéµ OUR SONG</button>
            </div>
        </div>
    </section>

    <video id="welcomeVideo" class="bg-video" autoplay muted loop playsinline><source src="heart.mp4" type="video/mp4"></video>
    <video id="letterVideo" class="bg-video" autoplay muted loop playsinline><source src="petals rose wedding background.mp4" type="video/mp4"></video>

    <section id="welcome" class="page-section">
        <div class="glass-card p-5 rounded-5 text-center shadow-lg" style="background: white; max-width: 500px; z-index: 10; border: 2px solid var(--p-pink);">
            <h1 style="font-size: 3rem; margin-bottom: 10px;">üíñ</h1>
            <h2 class="mb-2" style="font-family: 'Dancing Script'; font-size: 2.5rem; color: var(--d-pink);">Our Key Date</h2>
            <p class="text-muted small mb-4">Enter the day it all began (YYYYMMDD)</p>
            <div id="heart-input-container" class="d-flex justify-content-center gap-2 mb-4">
                <div class="heart-digit" data-index="0"></div>
                <div class="heart-digit" data-index="1"></div>
                <div class="heart-digit" data-index="2"></div>
                <div class="heart-digit" data-index="3"></div>
                <span class="heart-separator"></span>
                <div class="heart-digit" data-index="4"></div>
                <div class="heart-digit" data-index="5"></div>
                <span class="heart-separator"></span>
                <div class="heart-digit" data-index="6"></div>
                <div class="heart-digit" data-index="7"></div>
            </div>
            <input type="number" id="entryPass" style="opacity: 0; position: absolute; z-index: -1;">
            <button class="btn btn-danger w-100 rounded-pill py-2 shadow-sm" onclick="unlock()" style="background: var(--p-pink); border: none;">Unlock Our Story</button>
        </div>
    </section>

    <section id="quiz" class="page-section">
        <div class="quiz-card p-5 rounded-5 text-center shadow" style="max-width: 450px;">
            <h5 id="quiz-progress" class="text-muted small">QUEST 1/2</h5>
            <h3 id="question-text" class="my-4" style="color: var(--d-pink);"></h3>
            <div id="options-container"></div>
        </div>
    </section>

    <section id="story" class="page-section">
        <h2 class="text-white mb-3" style="font-family: 'Dancing Script'; font-size: 3.5rem;">Relive Our Journey</h2>
        <div id="adventure-map">
            <div class="map-point" style="top: 20%; left: 30%;" onclick="revealMapMemory(0, 20, 30)"><span class="heart-icon">‚ù§Ô∏è</span></div>
            <div class="map-point" style="top: 50%; left: 20%;" onclick="revealMapMemory(1, 60, 20)"><span class="heart-icon">‚ù§Ô∏è</span></div>
            <div class="map-point" style="top: 40%; left: 70%;" onclick="revealMapMemory(2, 40, 70)"><span class="heart-icon">‚ù§Ô∏è</span></div>
            <div class="map-point" style="top: 80%; left: 80%;" onclick="revealMapMemory(3, 80, 80)"><span class="heart-icon">‚ù§Ô∏è</span></div>
            <div class="map-point" style="top: 80%; left: 30%;" onclick="revealMapMemory(4, 70, 90)"><span class="heart-icon">‚ù§Ô∏è</span></div>
            <div id="map-photo-popup" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0); background: white; padding: 10px; border-radius: 5px; z-index: 20; transition: 0.5s;">
                <img id="popup-img" src="" style="width: 280px; height: 200px; object-fit: cover; object-position: top ;">
                <p id="popup-text" class="text-center mt-2" style="font-family: 'Dancing Script'; font-size: 1.3rem; color: #333;"></p>
                <button class="btn btn-sm btn-outline-danger w-100" onclick="closePopup()">Close</button>
            </div>
        </div>
        <button id="nextStoryBtn" class="btn btn-light rounded-pill px-5 mt-4 shadow-lg" style="display:none;" onclick="showSection('cinematic-gallery', '')">Watch Our Movie... ‚Üí</button>
    </section>

    <section id="cinematic-gallery" class="page-section p-0">
        <div class="vignette-overlay"></div>
        <div id="gallery-controls" style="position: fixed; bottom: 40px; right: 40px; z-index: 1000; display: none;">
            <button class="btn btn-light rounded-circle shadow" id="playPauseBtn" onclick="toggleAutoScroll()" style="width:60px; height:60px;">‚è∏Ô∏è</button>
        </div>
        <div class="horizontal-track">
            <div class="scroll-item" style="--rotation: 3deg;"><img src="p2.jpg"><p>Your laugh is my home.</p></div>
            <div class="scroll-item" style="--rotation: -4deg;"><img src="p3.jpg"><p>Hand in hand, always.</p></div>
            <div class="scroll-item" style="--rotation: 2deg;"><img src="p4.jpg"><p>A secret day for us.</p></div>
            <div class="scroll-item" style="--rotation: -3deg;"><img src="p5.jpeg"><p>Looking at you is a dream.</p></div>
            <div class="scroll-item" style="--rotation: 1deg;"><img src="p19.jpg"><p>Our first coffee date.</p></div>
            <div class="scroll-item" style="--rotation: -2deg;"><img src="p7.jpeg"><p>Starry nights together.</p></div>
            <div class="scroll-item" style="--rotation: 4deg;"><img src="p8.jpg"><p>Your smile lights up my world.</p></div>
            <div class="scroll-item" style="--rotation: -1deg;"><img src="p9.jpg"><p>Adventures await us.</p></div>
            <div class="scroll-item" style="--rotation: 2.5deg;"><img src="p10.jpg"><p>Forever and always.</p></div>
            <div class="scroll-item" style="--rotation: -3.5deg;"><img src="p11.jpg"><p>Our special moments.</p></div>
            <div class="scroll-item" style="--rotation: 1.5deg;"><img src="p12.jpg"><p>Laughter and love.</p></div>
            <div class="scroll-item" style="--rotation: -2.5deg;"><img src="p13.jpg"><p>Heart to heart talks.</p></div>
            <div class="scroll-item" style="--rotation: 3.5deg;"><img src="p14.jpg"><p>Building memories together.</p></div>
            <div class="scroll-item" style="--rotation: -1.5deg;"><img src="p15.jpg"><p>Your love completes me.</p></div>
            <div class="scroll-item" style="--rotation: 2deg;"><img src="p16.jpg"><p>Every day with you is special.</p></div>
            <div class="scroll-item" style="--rotation: -4deg;"><img src="p17.jpg"><p>Our beautiful journey.</p></div>
            <div class="scroll-item" style="--rotation: 1deg;"><img src="p18.jpg"><p>Love in every moment.</p></div>
            <div class="scroll-item" style="--rotation: -2deg;"><img src="p19.jpg"><p>Together forever.</p></div>
            <div style="display: inline-block; padding: 100px;">
                <button class="btn btn-danger btn-lg rounded-pill px-5 py-3 shadow-lg" onclick="proceedToProposal()">The Final Question... ‚ù§Ô∏è</button>
            </div>
        </div>
    </section>

    <section id="proposal" class="page-section">
        <div class="text-center text-white">
            <h1 class="display-1" style="font-family: 'Dancing Script';">DONUT üç©</h1>
            <h2 class="mb-5">Will you be mine forever?</h2>
            <div class="d-flex gap-4 justify-content-center">
                <button class="btn-yes" onclick="startLetter()">YES! üíç</button>
                <button id="noBtn" class="btn btn-outline-light rounded-pill px-4" onmouseover="moveNo()">No</button>
            </div>
        </div>
    </section>

    <section id="letter" class="page-section">
        <div class="glass-card p-5 rounded-5 shadow-lg" style="background: white; max-width: 600px; z-index: 10;">
            <div id="letter-text" style="font-family: 'Dancing Script'; font-size: 2rem; color: var(--d-pink); line-height: 1.5; min-height: 100px;"></div>
            <button id="seeCertBtn" class="btn btn-danger rounded-pill mt-4 px-4" style="display:none;" onclick="showFinal()">Our Certificate</button>
        </div>
    </section>

    <section id="souvenir" class="page-section">
        <div class="certificate-container">
            <div class="certificate-inner">
                <h4 class="cert-header text-uppercase">Official Declaration of Love</h4>
                <h1 class="cert-title">Locked Forever</h1>
                <p class="mb-2">This certifies that a lifetime of happiness began for</p>
                <div class="cert-names">Ayushmaan & Diya</div>
                <div class="cert-footer">
                    <div class="text-start">
                        <p class="small mb-0 text-muted">Signed On</p>
                        <div class="cert-signature" id="yesTime"></div>
                    </div>
                    <div class="wax-seal"><span>Soulmates</span></div>
                    <div class="text-end">
                        <p class="small mb-0 text-muted">Bond Status</p>
                        <div class="cert-signature text-success">‚àû Eternal</div>
                    </div>
                </div>
            </div>
        </div>
        <div class="mt-4">
            <button class="btn btn-outline-dark btn-sm px-4 rounded-pill me-2" onclick="window.print()">Download Certificate</button>
            <button class="btn btn-danger btn-sm px-4 rounded-pill" onclick="showSection('developer-credit', '')">Final Note ‚Üí</button>
        </div>
    </section>

    <section id="developer-credit" class="page-section">
        <div class="container text-center">
            <div class="dev-card shadow-lg mx-auto" style="max-width: 600px;">
                <div class="mb-4" style="font-size: 4rem;">üë®‚Äçüíª</div>
                <h2 style="font-family: 'Dancing Script'; font-size: 3rem; color: var(--p-pink);">Created with Love</h2>
                <p class="lead text-white-50">Every line of code, every pixel, and every heartbeat of this website was crafted for you.</p>
                
                <hr style="border-color: rgba(255,255,255,0.1); margin: 30px 0;">
                
                <p class="mb-1 text-uppercase small" style="letter-spacing: 3px; color: #888;">Developed By</p>
                <h1 class="display-3 glow-text" style="font-family: 'Poppins';">AYUSHMAAN</h1>
                
                <p class="mt-4 italic" style="font-family: 'Dancing Script'; font-size: 1.5rem; color: #aaa;">"Because you are my greatest adventure."</p>
                
                <button class="btn btn-outline-light rounded-pill mt-5 px-5" onclick="location.reload()">Replay Story ‚Ü∫</button>
            </div>
        </div>
    </section>

    <div id="love-meter-container">
        <span>‚ù§Ô∏è</span>
        <div style="width: 150px; background: #eee; border-radius: 10px; overflow: hidden;"><div id="love-meter-fill"></div></div>
    </div>

    <script>
        const panda = document.getElementById('panda-pet');
        const meter = document.getElementById('love-meter-fill');
        const music = document.getElementById('bgMusic');
        let loveProgress = 0, isAutoScrolling = true, scrollInterval;
        let lastX = 0;

        function playDing() {
            const context = new (window.AudioContext || window.webkitAudioContext)();
            const osc = context.createOscillator();
            const gain = context.createGain();
            osc.type = 'sine';
            osc.frequency.setValueAtTime(880, context.currentTime);
            osc.frequency.exponentialRampToValueAtTime(1320, context.currentTime + 0.1);
            gain.gain.setValueAtTime(0.3, context.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.01, context.currentTime + 0.5);
            osc.connect(gain); gain.connect(context.destination);
            osc.start(); osc.stop(context.currentTime + 0.5);
        }

        function selectMusic(src) {
            music.src = src;
            music.play().catch(e => console.log("Audio play blocked"));
            showSection('welcome', 'bg-welcome');
        }

        document.addEventListener('mousemove', (e) => {
            const trail = document.createElement('div');
            trail.className = 'trail';
            trail.style.left = e.clientX + 'px';
            trail.style.top = e.clientY + 'px';
            document.body.appendChild(trail);
            setTimeout(() => trail.remove(), 800);

            if (e.clientX < lastX) panda.style.transform = 'scaleX(-1)';
            else panda.style.transform = 'scaleX(1)';
            lastX = e.clientX;
            panda.style.left = (e.clientX - 25) + 'px';
            panda.style.top = (e.clientY - 25) + 'px';
        });

        function updateMeter(val) {
            loveProgress = Math.min(val, 100);
            meter.style.width = loveProgress + '%';
            if(loveProgress === 100) confetti({ particleCount: 200, spread: 80 });
        }

        const quizData = [
            { q: "What year did we first meet?", a: "2021", opts: ["2019", "2021", "2023","2020"] }, 
            { q: "What is my favorite name for you?", a: "All of the above", opts: ["Babe", "DONUT üç©", "Sweetie","All of the above"] }
        ];
        let qIdx = 0;

        function loadQuiz() {
            const data = quizData[qIdx];
            const quizCard = document.querySelector('.quiz-card');
            document.getElementById('quiz-progress').innerText = `QUEST ${qIdx+1}/${quizData.length}`;
            document.getElementById('question-text').innerText = data.q;
            const cont = document.getElementById('options-container');
            cont.innerHTML = '';
            
            data.opts.forEach(o => {
                const b = document.createElement('button');
                b.className = 'btn option-btn w-100 mb-3 rounded-pill py-2';
                b.innerText = o;
                b.onclick = () => { 
                    if(o === data.a) { 
                        playDing();
                        confetti({ particleCount: 40, spread: 60, origin: { y: 0.7 } });
                        qIdx++; 
                        updateMeter(loveProgress + 20); 
                        if(qIdx < quizData.length) setTimeout(loadQuiz, 500); 
                        else showSection('story', 'bg-story'); 
                    } else {
                        quizCard.classList.add('shake');
                        setTimeout(() => quizCard.classList.remove('shake'), 400);
                        b.style.borderColor = "red";
                    }
                };
                cont.appendChild(b);
            });
        }

        function unlock() {
            if(document.getElementById('entryPass').value === "20210916") {
                document.getElementById('love-meter-container').style.display = 'flex';
                showSection('quiz', 'bg-quiz');
                loadQuiz();
                updateMeter(15);
            } else { 
                alert("Not the right date, my love!"); 
                document.getElementById('entryPass').value = ""; 
                document.querySelectorAll('.heart-digit').forEach(h => { h.innerText = ""; h.classList.remove('filled'); });
            }
        }

        function revealMapMemory(index, top, left) {
            const memories = [
                {img:"dandiay1.jpg", text:"Our first Dandiya Night!"}, 
                {img:"Gemin.png", text:"Our secret getaway."}, 
                {img:"p11.jpg", text:"Another beautiful night."}, 
                {img:"tg.jpeg", text:"Look at us! ‚ù§Ô∏è"},
                {img:"p17.jpg", text:"Our special anniversary!"}
            ];
            const popup = document.getElementById('map-photo-popup');
            const map = document.getElementById('adventure-map');
            const rect = map.getBoundingClientRect();
            panda.style.transition = "all 1s ease-in-out";
            panda.style.left = (rect.left + (rect.width * (left/100))) + 'px';
            panda.style.top = (rect.top + (rect.height * (top/100))) + 'px';
            setTimeout(() => {
                document.getElementById('popup-img').src = memories[index].img;
                document.getElementById('popup-text').innerText = memories[index].text;
                popup.style.transform = "translate(-50%, -50%) scale(1)";
                updateMeter(loveProgress + 10);
                if(loveProgress >= 65) document.getElementById('nextStoryBtn').style.display = 'inline-block';
                panda.style.transition = "none";
            }, 1000);
        }

        function closePopup() { document.getElementById('map-photo-popup').style.transform = "translate(-50%, -50%) scale(0)"; }
        function toggleAutoScroll() { isAutoScrolling = !isAutoScrolling; document.getElementById('playPauseBtn').innerText = isAutoScrolling ? "‚è∏Ô∏è" : "‚ñ∂Ô∏è"; if(isAutoScrolling) startScroll(); else clearInterval(scrollInterval); }
        function startScroll() { clearInterval(scrollInterval); const container = document.getElementById('cinematic-gallery'); scrollInterval = setInterval(() => { if(isAutoScrolling) container.scrollLeft += 1.5; }, 25); }
        function proceedToProposal() { clearInterval(scrollInterval); showSection('proposal', 'bg-proposal'); }

        function showSection(id, bg) {
            document.querySelectorAll('.page-section').forEach(s => { s.style.display = 'none'; s.classList.remove('active-section'); });
            const target = document.getElementById(id);
            target.style.display = 'flex';
            setTimeout(() => target.classList.add('active-section'), 10);
            if(bg) document.body.className = bg;
            if(id === 'cinematic-gallery') { document.getElementById('gallery-controls').style.display = 'block'; startScroll(); } 
            else { document.getElementById('gallery-controls').style.display = 'none'; }
        }

        function startLetter() {
            showSection('letter', 'bg-letter');
            updateMeter(100);
            let text = "My dearest Donut... Watching these memories makes me realize how lucky I am. You are my heart, my soul, and my forever. ‚ù§Ô∏è", i = 0;
            const container = document.getElementById('letter-text');
            container.innerHTML = "";
            function type() { if(i < text.length) { container.innerHTML += text.charAt(i); i++; setTimeout(type, 50); } else { document.getElementById('seeCertBtn').style.display = 'block'; } }
            type();
        }

        function showFinal() { document.getElementById('yesTime').innerText = new Date().toLocaleString(); showSection('souvenir', 'bg-souvenir'); confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } }); }
        function moveNo() { const b = document.getElementById('noBtn'); b.style.position = 'fixed'; b.style.left = Math.random() * 70 + 10 + '%'; b.style.top = Math.random() * 70 + 10 + '%'; }

        const entryInput = document.getElementById('entryPass');
        const heartDigits = document.querySelectorAll('.heart-digit');
        document.getElementById('heart-input-container').addEventListener('click', () => { entryInput.focus(); });
        entryInput.addEventListener('input', (e) => {
            const val = e.target.value.toString();
            heartDigits.forEach((heart, index) => {
                if (val[index]) { heart.innerText = val[index]; heart.classList.add('filled'); } 
                else { heart.innerText = ''; heart.classList.remove('filled'); }
            });
            if (val.length === 8) { setTimeout(unlock, 500); }
        });
    </script>
</body>
</html>
